2021-07-20 20:32:04,194 - INFO - {'lang': 'python', 'model': 'lstm', 'load': False, 'code_max_length': 200, 'desc_max_length': 30, 'vocab_max_size': 10000, 'vocab_min_freq': 10, 'bpe_pct': 0.5, 'batch_size': 1024, 'emb_dim': 128, 'hid_dim': 256, 'n_layers_lstm': 1, 'n_layers_trans': 3, 'n_heads': 8, 'bidirectional': True, 'word_Embedding': False, 'dropout': 0.1, 'pool_mode': 'weighted_mean', 'loss': 'softmax', 'lr': 0.0005, 'n_epochs': 300, 'patience': 15, 'grad_clip': 1.0, 'seed': 1, 'save_model': True, 'device': 'cuda', 'log_path': 'ret_runs/python-2021-07-20_20-32.log'}
2021-07-20 20:32:04,198 - INFO - using device:cuda
2021-07-20 20:32:34,828 - INFO - 412,178 training examples
2021-07-20 20:32:34,828 - INFO - 23,107 valid examples
2021-07-20 20:32:34,828 - INFO - 22,176 test examples
2021-07-20 20:32:34,828 - INFO - Code vocab size: 8,830
2021-07-20 20:32:34,829 - INFO - Description vocab size: 9,060
2021-07-20 20:32:35,176 - INFO - LSTM(128, 256, dropout=0.1, bidirectional=True)
2021-07-20 20:32:35,491 - INFO - LSTM(128, 256, dropout=0.1, bidirectional=True)
2021-07-20 20:32:38,454 - INFO - Code Encoder parameters: 1,986,432
2021-07-20 20:32:38,454 - INFO - Desc Encoder parameters: 2,015,872
2021-07-20 20:32:38,454 - INFO - Code Pooler parameters: 128
2021-07-20 20:32:38,454 - INFO - Desc Pooler parameters: 128
2021-07-20 20:33:58,240 - INFO - Epoch: 01
2021-07-20 20:33:58,240 - INFO - 	Train Loss: 6.451, Train MRR: 0.038
2021-07-20 20:33:58,240 - INFO - 	 Val. Loss: 6.198, Valid MRR: 0.049
2021-07-20 20:35:18,599 - INFO - Epoch: 02
2021-07-20 20:35:18,600 - INFO - 	Train Loss: 5.451, Train MRR: 0.116
2021-07-20 20:35:18,600 - INFO - 	 Val. Loss: 5.739, Valid MRR: 0.091
2021-07-20 20:36:41,272 - INFO - Epoch: 03
2021-07-20 20:36:41,272 - INFO - 	Train Loss: 4.804, Train MRR: 0.191
2021-07-20 20:36:41,272 - INFO - 	 Val. Loss: 5.460, Valid MRR: 0.124
2021-07-20 20:38:02,458 - INFO - Epoch: 04
2021-07-20 20:38:02,458 - INFO - 	Train Loss: 4.328, Train MRR: 0.257
2021-07-20 20:38:02,458 - INFO - 	 Val. Loss: 5.244, Valid MRR: 0.150
2021-07-20 20:39:23,391 - INFO - Epoch: 05
2021-07-20 20:39:23,392 - INFO - 	Train Loss: 3.959, Train MRR: 0.313
2021-07-20 20:39:23,392 - INFO - 	 Val. Loss: 5.092, Valid MRR: 0.175
2021-07-20 20:40:44,935 - INFO - Epoch: 06
2021-07-20 20:40:44,935 - INFO - 	Train Loss: 3.654, Train MRR: 0.360
2021-07-20 20:40:44,935 - INFO - 	 Val. Loss: 4.974, Valid MRR: 0.191
2021-07-20 20:42:06,326 - INFO - Epoch: 07
2021-07-20 20:42:06,327 - INFO - 	Train Loss: 3.398, Train MRR: 0.401
2021-07-20 20:42:06,327 - INFO - 	 Val. Loss: 4.941, Valid MRR: 0.207
2021-07-20 20:43:27,742 - INFO - Epoch: 08
2021-07-20 20:43:27,742 - INFO - 	Train Loss: 3.179, Train MRR: 0.436
2021-07-20 20:43:27,743 - INFO - 	 Val. Loss: 4.913, Valid MRR: 0.216
2021-07-20 20:44:49,314 - INFO - Epoch: 09
2021-07-20 20:44:49,314 - INFO - 	Train Loss: 2.980, Train MRR: 0.468
2021-07-20 20:44:49,314 - INFO - 	 Val. Loss: 4.854, Valid MRR: 0.226
2021-07-20 20:46:11,125 - INFO - Epoch: 10
2021-07-20 20:46:11,126 - INFO - 	Train Loss: 2.802, Train MRR: 0.498
2021-07-20 20:46:11,126 - INFO - 	 Val. Loss: 4.849, Valid MRR: 0.237
2021-07-20 20:47:32,873 - INFO - Epoch: 11
2021-07-20 20:47:32,873 - INFO - 	Train Loss: 2.641, Train MRR: 0.525
2021-07-20 20:47:32,873 - INFO - 	 Val. Loss: 4.823, Valid MRR: 0.244
2021-07-20 20:48:55,885 - INFO - Epoch: 12
2021-07-20 20:48:55,885 - INFO - 	Train Loss: 2.492, Train MRR: 0.550
2021-07-20 20:48:55,886 - INFO - 	 Val. Loss: 4.866, Valid MRR: 0.250
2021-07-20 20:50:17,223 - INFO - Epoch: 13
2021-07-20 20:50:17,223 - INFO - 	Train Loss: 2.357, Train MRR: 0.573
2021-07-20 20:50:17,223 - INFO - 	 Val. Loss: 4.833, Valid MRR: 0.256
2021-07-20 20:51:38,871 - INFO - Epoch: 14
2021-07-20 20:51:38,871 - INFO - 	Train Loss: 2.230, Train MRR: 0.594
2021-07-20 20:51:38,871 - INFO - 	 Val. Loss: 4.819, Valid MRR: 0.261
2021-07-20 20:53:00,481 - INFO - Epoch: 15
2021-07-20 20:53:00,481 - INFO - 	Train Loss: 2.112, Train MRR: 0.615
2021-07-20 20:53:00,481 - INFO - 	 Val. Loss: 4.944, Valid MRR: 0.264
2021-07-20 20:54:21,211 - INFO - Epoch: 16
2021-07-20 20:54:21,211 - INFO - 	Train Loss: 2.004, Train MRR: 0.634
2021-07-20 20:54:21,211 - INFO - 	 Val. Loss: 4.988, Valid MRR: 0.265
2021-07-20 20:55:42,952 - INFO - Epoch: 17
2021-07-20 20:55:42,953 - INFO - 	Train Loss: 1.899, Train MRR: 0.652
2021-07-20 20:55:42,953 - INFO - 	 Val. Loss: 5.003, Valid MRR: 0.267
2021-07-20 20:57:04,773 - INFO - Epoch: 18
2021-07-20 20:57:04,774 - INFO - 	Train Loss: 1.804, Train MRR: 0.668
2021-07-20 20:57:04,774 - INFO - 	 Val. Loss: 5.100, Valid MRR: 0.272
2021-07-20 20:58:26,441 - INFO - Epoch: 19
2021-07-20 20:58:26,442 - INFO - 	Train Loss: 1.713, Train MRR: 0.683
2021-07-20 20:58:26,442 - INFO - 	 Val. Loss: 5.109, Valid MRR: 0.272
2021-07-20 20:59:47,715 - INFO - Epoch: 20
2021-07-20 20:59:47,716 - INFO - 	Train Loss: 1.625, Train MRR: 0.699
2021-07-20 20:59:47,716 - INFO - 	 Val. Loss: 5.295, Valid MRR: 0.275
2021-07-20 21:01:11,091 - INFO - Epoch: 21
2021-07-20 21:01:11,091 - INFO - 	Train Loss: 1.546, Train MRR: 0.713
2021-07-20 21:01:11,092 - INFO - 	 Val. Loss: 5.289, Valid MRR: 0.276
2021-07-20 21:02:32,599 - INFO - Epoch: 22
2021-07-20 21:02:32,599 - INFO - 	Train Loss: 1.471, Train MRR: 0.726
2021-07-20 21:02:32,599 - INFO - 	 Val. Loss: 5.376, Valid MRR: 0.279
2021-07-20 21:03:54,083 - INFO - Epoch: 23
2021-07-20 21:03:54,083 - INFO - 	Train Loss: 1.398, Train MRR: 0.739
2021-07-20 21:03:54,083 - INFO - 	 Val. Loss: 5.341, Valid MRR: 0.277
2021-07-20 21:05:15,690 - INFO - Epoch: 24
2021-07-20 21:05:15,690 - INFO - 	Train Loss: 1.331, Train MRR: 0.752
2021-07-20 21:05:15,690 - INFO - 	 Val. Loss: 5.647, Valid MRR: 0.275
2021-07-20 21:06:37,376 - INFO - Epoch: 25
2021-07-20 21:06:37,377 - INFO - 	Train Loss: 1.266, Train MRR: 0.763
2021-07-20 21:06:37,377 - INFO - 	 Val. Loss: 5.560, Valid MRR: 0.275
2021-07-20 21:07:58,845 - INFO - Epoch: 26
2021-07-20 21:07:58,845 - INFO - 	Train Loss: 1.206, Train MRR: 0.774
2021-07-20 21:07:58,845 - INFO - 	 Val. Loss: 5.701, Valid MRR: 0.276
2021-07-20 21:09:20,466 - INFO - Epoch: 27
2021-07-20 21:09:20,466 - INFO - 	Train Loss: 1.149, Train MRR: 0.783
2021-07-20 21:09:20,466 - INFO - 	 Val. Loss: 5.767, Valid MRR: 0.278
2021-07-20 21:10:41,786 - INFO - Epoch: 28
2021-07-20 21:10:41,786 - INFO - 	Train Loss: 1.093, Train MRR: 0.794
2021-07-20 21:10:41,786 - INFO - 	 Val. Loss: 5.952, Valid MRR: 0.277
2021-07-20 21:12:03,322 - INFO - Epoch: 29
2021-07-20 21:12:03,322 - INFO - 	Train Loss: 1.044, Train MRR: 0.803
2021-07-20 21:12:03,322 - INFO - 	 Val. Loss: 6.106, Valid MRR: 0.277
2021-07-20 21:13:25,832 - INFO - Epoch: 30
2021-07-20 21:13:25,832 - INFO - 	Train Loss: 0.995, Train MRR: 0.812
2021-07-20 21:13:25,833 - INFO - 	 Val. Loss: 6.047, Valid MRR: 0.277
2021-07-20 21:14:47,437 - INFO - Epoch: 31
2021-07-20 21:14:47,437 - INFO - 	Train Loss: 0.949, Train MRR: 0.821
2021-07-20 21:14:47,437 - INFO - 	 Val. Loss: 6.442, Valid MRR: 0.276
2021-07-20 21:16:09,225 - INFO - Epoch: 32
2021-07-20 21:16:09,225 - INFO - 	Train Loss: 0.907, Train MRR: 0.828
2021-07-20 21:16:09,225 - INFO - 	 Val. Loss: 6.536, Valid MRR: 0.277
2021-07-20 21:17:30,379 - INFO - Epoch: 33
2021-07-20 21:17:30,379 - INFO - 	Train Loss: 0.867, Train MRR: 0.836
2021-07-20 21:17:30,379 - INFO - 	 Val. Loss: 6.656, Valid MRR: 0.275
2021-07-20 21:18:52,172 - INFO - Epoch: 34
2021-07-20 21:18:52,172 - INFO - 	Train Loss: 0.831, Train MRR: 0.843
2021-07-20 21:18:52,172 - INFO - 	 Val. Loss: 6.717, Valid MRR: 0.277
2021-07-20 21:20:13,650 - INFO - Epoch: 35
2021-07-20 21:20:13,650 - INFO - 	Train Loss: 0.796, Train MRR: 0.849
2021-07-20 21:20:13,651 - INFO - 	 Val. Loss: 6.972, Valid MRR: 0.274
2021-07-20 21:21:35,698 - INFO - Epoch: 36
2021-07-20 21:21:35,698 - INFO - 	Train Loss: 0.761, Train MRR: 0.856
2021-07-20 21:21:35,698 - INFO - 	 Val. Loss: 6.734, Valid MRR: 0.275
2021-07-20 21:22:56,920 - INFO - Epoch: 37
2021-07-20 21:22:56,920 - INFO - 	Train Loss: 0.734, Train MRR: 0.860
2021-07-20 21:22:56,920 - INFO - 	 Val. Loss: 7.240, Valid MRR: 0.274
2021-07-20 21:22:56,922 - INFO - Ended early due to losing patience!
